{"cells":[{"cell_type":"markdown","source":["# Data preperation tool"],"metadata":{"id":"aWqDxOXbA9Pg"}},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wTW3fUASFc5G","executionInfo":{"status":"ok","timestamp":1686380217528,"user_tz":-330,"elapsed":27311,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"d7a955a5-0ea7-49d7-fb76-8815afd1187b"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["import numpy as np\n","import matplotlib.pyplot as plt\n","import pandas as pd"],"metadata":{"id":"om9aycadBfY_","executionInfo":{"status":"ok","timestamp":1686380380993,"user_tz":-330,"elapsed":517,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["dataset = pd.read_csv('/content/drive/MyDrive/Machine Learning-A-Z-Codes-Datasets/Machine Learning A-Z (Codes and Datasets)/Part 1 - Data Preprocessing/Section 2 -------------------- Part 1 - Data Preprocessing --------------------/Python/Data.csv')\n","x = dataset.iloc[:, :-1].values\n","y = dataset.iloc[:, -1].values"],"metadata":{"id":"2CfwPBIYHQcq","executionInfo":{"status":"ok","timestamp":1686390620457,"user_tz":-330,"elapsed":655,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":59,"outputs":[]},{"cell_type":"code","source":["print(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"z-Ok5AddMl6x","executionInfo":{"status":"ok","timestamp":1686390629794,"user_tz":-330,"elapsed":540,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"48631cbb-941c-41f3-f127-47215a1552a4"},"execution_count":60,"outputs":[{"output_type":"stream","name":"stdout","text":["[['France' 44.0 72000.0]\n"," ['Spain' 27.0 48000.0]\n"," ['Germany' 30.0 54000.0]\n"," ['Spain' 38.0 61000.0]\n"," ['Germany' 40.0 nan]\n"," ['France' 35.0 58000.0]\n"," ['Spain' nan 52000.0]\n"," ['France' 48.0 79000.0]\n"," ['Germany' 50.0 83000.0]\n"," ['France' 37.0 67000.0]]\n"]}]},{"cell_type":"code","source":["print(y)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lyAtyu7MPgAk","executionInfo":{"status":"ok","timestamp":1686390634342,"user_tz":-330,"elapsed":459,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"067461af-6705-4895-e6fd-0cb0108bf4bb"},"execution_count":61,"outputs":[{"output_type":"stream","name":"stdout","text":["['No' 'Yes' 'No' 'No' 'Yes' 'Yes' 'No' 'Yes' 'No' 'Yes']\n"]}]},{"cell_type":"markdown","source":["Take care of missing data"],"metadata":{"id":"dRI4jeIHQnkA"}},{"cell_type":"code","source":["from sklearn.impute import SimpleImputer\n","imputer = SimpleImputer(missing_values=np.nan , strategy='mean')\n","imputer.fit(x[:, 1:3])\n","x[:, 1:3] = imputer.transform(x[:, 1:3])"],"metadata":{"id":"aY5M1uroQ1MW","executionInfo":{"status":"ok","timestamp":1686390651016,"user_tz":-330,"elapsed":438,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":62,"outputs":[]},{"cell_type":"code","source":["print(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tBORT4KLTfjp","executionInfo":{"status":"ok","timestamp":1686390657280,"user_tz":-330,"elapsed":501,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"a3b91c81-89e9-417c-e555-61628847b9a8"},"execution_count":63,"outputs":[{"output_type":"stream","name":"stdout","text":["[['France' 44.0 72000.0]\n"," ['Spain' 27.0 48000.0]\n"," ['Germany' 30.0 54000.0]\n"," ['Spain' 38.0 61000.0]\n"," ['Germany' 40.0 63777.77777777778]\n"," ['France' 35.0 58000.0]\n"," ['Spain' 38.77777777777778 52000.0]\n"," ['France' 48.0 79000.0]\n"," ['Germany' 50.0 83000.0]\n"," ['France' 37.0 67000.0]]\n"]}]},{"cell_type":"markdown","source":["Encoding categorical data"],"metadata":{"id":"fEKxSDYnUFOh"}},{"cell_type":"markdown","source":["Independent Variable"],"metadata":{"id":"oT_871GPU3bK"}},{"cell_type":"code","source":["from sklearn.compose import ColumnTransformer\n","from sklearn.preprocessing import OneHotEncoder\n","ct = ColumnTransformer(transformers =[('encoder', OneHotEncoder(), [0])] , remainder ='passthrough' )\n","x = np.array(ct.fit_transform(x))\n"],"metadata":{"id":"kRhd6jPkUN0c","executionInfo":{"status":"ok","timestamp":1686390711096,"user_tz":-330,"elapsed":439,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":64,"outputs":[]},{"cell_type":"code","source":["print(x)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"itOm76pCXNHQ","executionInfo":{"status":"ok","timestamp":1686390714506,"user_tz":-330,"elapsed":469,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"1a06e315-4983-4501-f92f-a6ad3df54a40"},"execution_count":65,"outputs":[{"output_type":"stream","name":"stdout","text":["[[1.0 0.0 0.0 44.0 72000.0]\n"," [0.0 0.0 1.0 27.0 48000.0]\n"," [0.0 1.0 0.0 30.0 54000.0]\n"," [0.0 0.0 1.0 38.0 61000.0]\n"," [0.0 1.0 0.0 40.0 63777.77777777778]\n"," [1.0 0.0 0.0 35.0 58000.0]\n"," [0.0 0.0 1.0 38.77777777777778 52000.0]\n"," [1.0 0.0 0.0 48.0 79000.0]\n"," [0.0 1.0 0.0 50.0 83000.0]\n"," [1.0 0.0 0.0 37.0 67000.0]]\n"]}]},{"cell_type":"markdown","source":["Dependendent Variable"],"metadata":{"id":"a6ukhFsxX3jx"}},{"cell_type":"code","source":["from sklearn.preprocessing import LabelEncoder\n","le = LabelEncoder()\n","y = le.fit_transform(y)"],"metadata":{"id":"N-_myM4GX94C","executionInfo":{"status":"ok","timestamp":1686390719359,"user_tz":-330,"elapsed":520,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":66,"outputs":[]},{"cell_type":"code","source":["print(y)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WoZt0CzCYVxb","executionInfo":{"status":"ok","timestamp":1686390721928,"user_tz":-330,"elapsed":3,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"96bf60b9-96b4-42da-f740-e08762ee6157"},"execution_count":67,"outputs":[{"output_type":"stream","name":"stdout","text":["[0 1 0 0 1 1 0 1 0 1]\n"]}]},{"cell_type":"markdown","source":["Splitting dataset into training set and test set"],"metadata":{"id":"EfwJ_CHSaIhG"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","x_train, x_test, y_train , y_test = train_test_split(x, y, test_size = 0.2 , random_state = 1)\n","\n"],"metadata":{"id":"C9F2rJQ-aV1-","executionInfo":{"status":"ok","timestamp":1686390736646,"user_tz":-330,"elapsed":516,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":68,"outputs":[]},{"cell_type":"code","source":["print(x_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oPYGKPMZhPIZ","executionInfo":{"status":"ok","timestamp":1686390739688,"user_tz":-330,"elapsed":481,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"318aa3d7-8a71-4f2e-c145-2ad5ac5dcc5f"},"execution_count":69,"outputs":[{"output_type":"stream","name":"stdout","text":["[[0.0 0.0 1.0 38.77777777777778 52000.0]\n"," [0.0 1.0 0.0 40.0 63777.77777777778]\n"," [1.0 0.0 0.0 44.0 72000.0]\n"," [0.0 0.0 1.0 38.0 61000.0]\n"," [0.0 0.0 1.0 27.0 48000.0]\n"," [1.0 0.0 0.0 48.0 79000.0]\n"," [0.0 1.0 0.0 50.0 83000.0]\n"," [1.0 0.0 0.0 35.0 58000.0]]\n"]}]},{"cell_type":"code","source":["print(x_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GFTrDk7bhPWG","executionInfo":{"status":"ok","timestamp":1686390743939,"user_tz":-330,"elapsed":451,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"144b0ab0-aac5-4eb1-f681-2ce7a9a9676d"},"execution_count":70,"outputs":[{"output_type":"stream","name":"stdout","text":["[[0.0 1.0 0.0 30.0 54000.0]\n"," [1.0 0.0 0.0 37.0 67000.0]]\n"]}]},{"cell_type":"code","source":["print(y_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"iSI3NJkkhPhh","executionInfo":{"status":"ok","timestamp":1686390746880,"user_tz":-330,"elapsed":634,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"75dbaf07-8c20-4d00-d2f1-6973b9b641ee"},"execution_count":71,"outputs":[{"output_type":"stream","name":"stdout","text":["[0 1 0 0 1 1 0 1]\n"]}]},{"cell_type":"code","source":["print(y_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"giLFk0UmhPub","executionInfo":{"status":"ok","timestamp":1686390750210,"user_tz":-330,"elapsed":512,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"ebafa11e-7ddb-4fbf-bd7d-17c68af56897"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stdout","text":["[0 1]\n"]}]},{"cell_type":"markdown","source":["Feature Scaling"],"metadata":{"id":"RSRLPeXuoT9i"}},{"cell_type":"code","source":["from sklearn.preprocessing import StandardScaler\n","sc = StandardScaler()\n","x_train[:, 3:] = sc.fit_transform(x_train[:, 3:])\n","x_test[:, 3:] = sc.transform(x_test[:, 3:])"],"metadata":{"id":"ioS-40daoajP","executionInfo":{"status":"ok","timestamp":1686390819850,"user_tz":-330,"elapsed":491,"user":{"displayName":"yash","userId":"13670789074667148051"}}},"execution_count":74,"outputs":[]},{"cell_type":"code","source":["print(x_train)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"luYcHoKTuV5W","executionInfo":{"status":"ok","timestamp":1686390823464,"user_tz":-330,"elapsed":459,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"84413e28-b70d-4652-fd9b-344341d2ec53"},"execution_count":75,"outputs":[{"output_type":"stream","name":"stdout","text":["[[0.0 0.0 1.0 -0.1915918438457856 -1.0781259408412427]\n"," [0.0 1.0 0.0 -0.014117293757057902 -0.07013167641635401]\n"," [1.0 0.0 0.0 0.5667085065333239 0.6335624327104546]\n"," [0.0 0.0 1.0 -0.3045301939022488 -0.30786617274297895]\n"," [0.0 0.0 1.0 -1.901801144700799 -1.4204636155515822]\n"," [1.0 0.0 0.0 1.1475343068237056 1.2326533634535488]\n"," [0.0 1.0 0.0 1.4379472069688966 1.5749910381638883]\n"," [1.0 0.0 0.0 -0.7401495441200352 -0.5646194287757336]]\n"]}]},{"cell_type":"code","source":["print(x_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YIGfrcoXubb2","executionInfo":{"status":"ok","timestamp":1686390825826,"user_tz":-330,"elapsed":3,"user":{"displayName":"yash","userId":"13670789074667148051"}},"outputId":"55d29a90-5395-4e86-8c0d-84e14da41a4a"},"execution_count":76,"outputs":[{"output_type":"stream","name":"stdout","text":["[[0.0 1.0 0.0 -1.4661817944830127 -0.9069571034860731]\n"," [1.0 0.0 0.0 -0.44973664397484425 0.20564033932253029]]\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1686247067190}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}